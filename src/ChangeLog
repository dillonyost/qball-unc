------------------------------------------------------------------------
r272 | xavier | 2016-04-20 16:21:09 -0700 (Wed, 20 Apr 2016) | 2 lines

Removed some debugging output.

------------------------------------------------------------------------
r269 | xavier | 2016-04-12 21:14:14 -0700 (Tue, 12 Apr 2016) | 2 lines

Moved orbitals to a Spline object.

------------------------------------------------------------------------
r267 | xavier | 2016-04-12 20:47:55 -0700 (Tue, 12 Apr 2016) | 4 lines

* Renamed local_potential to local_potential_g_.
* Moved projectors to a Spline object.


------------------------------------------------------------------------
r266 | xavier | 2016-04-12 20:19:33 -0700 (Tue, 12 Apr 2016) | 5 lines

* Defined a class for splines.
* Renamed spline.h and spline.C to Spline.h and Spline.C.
* Use the Spline class for the local potential.


------------------------------------------------------------------------
r265 | xavier | 2016-04-12 20:18:26 -0700 (Tue, 12 Apr 2016) | 2 lines

Check for non-diagonal ONCV pseudos, that are not currently supported.

------------------------------------------------------------------------
r261 | xavier | 2016-04-11 22:50:22 -0700 (Mon, 11 Apr 2016) | 4 lines

* Corrected output.
* Added an assertion.


------------------------------------------------------------------------
r260 | xavier | 2016-04-11 22:47:50 -0700 (Mon, 11 Apr 2016) | 2 lines

Bugfix: correct calculation of indices.

------------------------------------------------------------------------
r259 | xavier | 2016-04-11 00:11:47 -0700 (Mon, 11 Apr 2016) | 3 lines

Use a separate array for the ONCV projectors.


------------------------------------------------------------------------
r258 | xavier | 2016-04-10 00:24:04 -0700 (Sun, 10 Apr 2016) | 2 lines

Bugfix: Fixed size of ONCV radial grid.

------------------------------------------------------------------------
r257 | xavier | 2016-04-10 00:00:55 -0700 (Sun, 10 Apr 2016) | 2 lines

Fixed initialization of ONCV projectors in Fourier space.

------------------------------------------------------------------------
r256 | xavier | 2016-04-09 23:04:11 -0700 (Sat, 09 Apr 2016) | 2 lines

ONCVs are always non-local.

------------------------------------------------------------------------
r255 | xavier | 2016-04-09 22:24:43 -0700 (Sat, 09 Apr 2016) | 4 lines

Connected the ONCV pseudos to the NonLocalPotential. The
implementation is in principle complete, but not tested.


------------------------------------------------------------------------
r254 | xavier | 2016-04-09 22:23:50 -0700 (Sat, 09 Apr 2016) | 4 lines

Do not hide the makedepend command, so it is easier to understand
errors.


------------------------------------------------------------------------
r253 | xavier | 2016-04-09 19:11:52 -0700 (Sat, 09 Apr 2016) | 3 lines

Added channels to the vnlg_ and vnlg_spl arrays.


------------------------------------------------------------------------
r252 | xavier | 2016-04-09 18:40:43 -0700 (Sat, 09 Apr 2016) | 3 lines

Use the vlnr_ array for all norm conserving pseudos.


------------------------------------------------------------------------
r251 | xavier | 2016-04-09 18:10:18 -0700 (Sat, 09 Apr 2016) | 2 lines

Added channels to the pseudopotential weights.

------------------------------------------------------------------------
r250 | xavier | 2016-04-08 18:39:09 -0700 (Fri, 08 Apr 2016) | 2 lines

A bit more of the ONCV implementation.

------------------------------------------------------------------------
r249 | xavier | 2016-04-03 22:41:57 -0700 (Sun, 03 Apr 2016) | 3 lines

More initialization of ONCV pseudos.


------------------------------------------------------------------------
r248 | xavier | 2016-04-03 22:14:20 -0700 (Sun, 03 Apr 2016) | 3 lines

Started to modify the Species initlization routine to handle ONCV
pseudos.

------------------------------------------------------------------------
r247 | xavier | 2016-04-03 11:29:25 -0700 (Sun, 03 Apr 2016) | 2 lines

Broadcast of ONCV components.

------------------------------------------------------------------------
r246 | xavier | 2016-04-03 09:59:26 -0700 (Sun, 03 Apr 2016) | 4 lines

* Rearranged all the ONCV-specific components of Species.
* Read the ONCV weights.


------------------------------------------------------------------------
r245 | xavier | 2016-04-02 19:22:09 -0700 (Sat, 02 Apr 2016) | 2 lines

Read the ONCV projectos and potential from the file.

------------------------------------------------------------------------
r244 | xavier | 2016-04-02 17:16:40 -0700 (Sat, 02 Apr 2016) | 2 lines

Started implementation of ONCV pseudos.

------------------------------------------------------------------------
r243 | xavier | 2016-04-02 13:51:01 -0700 (Sat, 02 Apr 2016) | 2 lines

Improved error handling.

------------------------------------------------------------------------
r242 | xavier | 2016-04-02 12:01:31 -0700 (Sat, 02 Apr 2016) | 4 lines

Non-linear core corrections are read using the same code for
norm-conserving and ultra-soft.


------------------------------------------------------------------------
r241 | xavier | 2016-04-02 11:53:08 -0700 (Sat, 02 Apr 2016) | 2 lines

Read of the nlcc using the method.

------------------------------------------------------------------------
r239 | xavier | 2016-04-02 09:32:38 -0700 (Sat, 02 Apr 2016) | 3 lines

Read radial functions using the new approach.


------------------------------------------------------------------------
r238 | xavier | 2016-04-02 08:54:04 -0700 (Sat, 02 Apr 2016) | 4 lines

* Implemented a method to read a sequence of values from a tag.
* Use this method to read the radial potential.


------------------------------------------------------------------------
r237 | xavier | 2016-04-01 22:32:17 -0700 (Fri, 01 Apr 2016) | 4 lines

* Function to read attributes.
* Converted more code to use XMLFile.


------------------------------------------------------------------------
r236 | xavier | 2016-04-01 19:20:04 -0700 (Fri, 01 Apr 2016) | 2 lines

Implemented the XMLFile class.

------------------------------------------------------------------------
r235 | xavier | 2016-04-01 09:28:56 -0700 (Fri, 01 Apr 2016) | 4 lines

* Moved the Tag class into the XMLFile class.
* Fixed a compilation issue.


------------------------------------------------------------------------
r232 | xavier | 2016-04-01 08:00:27 -0700 (Fri, 01 Apr 2016) | 3 lines

Moved the Tag class to a separate file.


------------------------------------------------------------------------
r231 | xavier | 2016-03-31 21:03:59 -0700 (Thu, 31 Mar 2016) | 4 lines

More simplification of the xml pseudopotential parsing using the Tag
object.


------------------------------------------------------------------------
r230 | xavier | 2016-03-31 20:36:32 -0700 (Thu, 31 Mar 2016) | 2 lines

Defined a class to help parsing the XML pseudopotential files.

------------------------------------------------------------------------
r228 | xavier | 2016-03-09 14:37:11 -0800 (Wed, 09 Mar 2016) | 4 lines

When qb receives the input file as argument, it stops with an error if
there is an invalid command.


------------------------------------------------------------------------
r226 | xavier | 2016-03-09 10:43:48 -0800 (Wed, 09 Mar 2016) | 4 lines

Now the qb executable honors the -c argument, that prints
configuration information (for the moment mpi).


------------------------------------------------------------------------
r223 | xavier | 2016-03-08 18:07:18 -0800 (Tue, 08 Mar 2016) | 4 lines

Added an iteration count as attribute to etotal_int, to make the
output more readable.


------------------------------------------------------------------------
r221 | xavier | 2016-03-04 16:20:25 -0800 (Fri, 04 Mar 2016) | 5 lines

- Initial implementation of the qbdiff utility, that compares two qbox
  output files. For the moment only the number of iterations and the
  total energy for each iteration is compared.


------------------------------------------------------------------------
r220 | xavier | 2016-03-03 15:40:04 -0800 (Thu, 03 Mar 2016) | 3 lines

Ignore failure to remove directory with `make clean`.


------------------------------------------------------------------------
r215 | draeger | 2016-03-02 15:19:19 -0800 (Wed, 02 Mar 2016) | 4 lines


Added error checking for currently-unsupported DFT+U case where hubbard l = llocal.


------------------------------------------------------------------------
r213 | xavier | 2016-03-02 14:00:39 -0800 (Wed, 02 Mar 2016) | 3 lines

Bugfix: corrected the inteface for Csys2blacs_handle.


------------------------------------------------------------------------
r211 | draeger | 2016-03-02 11:40:21 -0800 (Wed, 02 Mar 2016) | 4 lines


SVN permissions test.


------------------------------------------------------------------------
r210 | draeger | 2016-02-26 14:35:20 -0800 (Fri, 26 Feb 2016) | 4 lines


Bug fix in HubbardPotential.C (hubbard occupations only computed up to 32 atoms).


------------------------------------------------------------------------
r209 | draeger | 2016-02-26 14:10:12 -0800 (Fri, 26 Feb 2016) | 1 line


------------------------------------------------------------------------
r208 | draeger | 2016-02-26 14:09:16 -0800 (Fri, 26 Feb 2016) | 3 lines

Removed some debugging code and disabled some ultrasoft debugging print statements.


------------------------------------------------------------------------
r207 | draeger | 2015-06-18 08:50:02 -0700 (Thu, 18 Jun 2015) | 3 lines

Added Cray make files, used to build code on Cielito with both Cray and Intel compilers.


------------------------------------------------------------------------
r206 | draeger | 2015-05-26 13:06:21 -0700 (Tue, 26 May 2015) | 1 line


------------------------------------------------------------------------
r205 | draeger | 2015-05-26 13:06:02 -0700 (Tue, 26 May 2015) | 3 lines

Updated FourierTransform with latest code from Davis version 1.61.0, which includes support for FFTW3.  Tested ESM code with water molecule and different FFT libraries and got identical results.


------------------------------------------------------------------------
r204 | draeger | 2015-05-22 16:02:41 -0700 (Fri, 22 May 2015) | 3 lines

Added constant-mu ESM code.


------------------------------------------------------------------------
r203 | draeger | 2015-05-22 15:01:10 -0700 (Fri, 22 May 2015) | 1 line


------------------------------------------------------------------------
r202 | draeger | 2015-04-10 10:30:41 -0700 (Fri, 10 Apr 2015) | 4 lines


Modified testMatrix to include transpose arguments.


------------------------------------------------------------------------
r200 | draeger | 2015-04-07 09:54:18 -0700 (Tue, 07 Apr 2015) | 4 lines


Replaced a few more norm() calls w. manual calculations to get better performance.


------------------------------------------------------------------------
r199 | draeger | 2015-04-01 09:58:56 -0700 (Wed, 01 Apr 2015) | 4 lines


Added summary_start/stop calls to limit MPI profiling to HPM region.


------------------------------------------------------------------------
r189 | draeger | 2015-02-26 16:41:23 -0800 (Thu, 26 Feb 2015) | 4 lines


Wrote test code to measure performance of row broadcasts (task mapping makes a BIG difference on BG/Q, as it turns out).


------------------------------------------------------------------------
r188 | draeger | 2015-02-26 16:40:43 -0800 (Thu, 26 Feb 2015) | 4 lines


Added BG/Q torus information to qb.C.


------------------------------------------------------------------------
r183 | draeger | 2014-10-08 14:24:11 -0700 (Wed, 08 Oct 2014) | 4 lines


Bug fix for ESM code, provided by Minoru Otani.


------------------------------------------------------------------------
r182 | draeger | 2014-09-10 15:27:06 -0700 (Wed, 10 Sep 2014) | 4 lines


Added extra calculations to sync up positions and velocities in MD save when savefreq variable used.


------------------------------------------------------------------------
r181 | draeger | 2014-08-27 13:04:05 -0700 (Wed, 27 Aug 2014) | 4 lines


Fixed bugs in ESM implementation.


------------------------------------------------------------------------
r180 | draeger | 2014-08-22 16:50:48 -0700 (Fri, 22 Aug 2014) | 4 lines


Fixed bug in SavedenCmd.C, where every task was trying to open the file.  This caused a hang on vulcan.


------------------------------------------------------------------------
r179 | draeger | 2014-08-07 15:07:21 -0700 (Thu, 07 Aug 2014) | 4 lines


Added Minoru Otani's ESM implementation to qb@ll, already tested in Davis Qbox 1.60.0.


------------------------------------------------------------------------
r178 | draeger | 2014-05-21 14:24:07 -0700 (Wed, 21 May 2014) | 4 lines


Fixed bug in Wavefunction.diag where eigenvalues were not being correctly updated in SlaterDet when kpoint = gamma.


------------------------------------------------------------------------
r174 | draeger | 2014-04-24 14:34:42 -0700 (Thu, 24 Apr 2014) | 4 lines


Modified save -casino to improve performance when many k-points are used.


------------------------------------------------------------------------
r173 | draeger | 2014-04-23 11:09:26 -0700 (Wed, 23 Apr 2014) | 4 lines


Avoid allocating dtwnl arrays when stress variable not defined.


------------------------------------------------------------------------
r172 | draeger | 2014-04-15 17:37:15 -0700 (Tue, 15 Apr 2014) | 4 lines


Bug fix to square context copy code when nkpts > 1.


------------------------------------------------------------------------
r171 | draeger | 2014-04-15 15:47:58 -0700 (Tue, 15 Apr 2014) | 4 lines


Added code to copy square matrix data in place to a square context containing only the processes in the upper square of the rectangular process grid, to speed up Cholesky decomposition and eigensolve for large, very rectangular contexts.  Not extensively tested, but so far works in all tests and can produce a significant speedup.


------------------------------------------------------------------------
r170 | draeger | 2014-03-28 16:37:14 -0700 (Fri, 28 Mar 2014) | 4 lines


Added reset_vcm command to qb.C (it was in src directory, just not added within code) and updated qbLink.C to have same variables and commands as qb.C.


------------------------------------------------------------------------
r169 | draeger | 2014-03-22 15:38:52 -0700 (Sat, 22 Mar 2014) | 4 lines


Bug fix in NetCharge -- don't update_occ until SlaterDets are created.


------------------------------------------------------------------------
r168 | draeger | 2014-03-21 11:16:39 -0700 (Fri, 21 Mar 2014) | 4 lines


Enabled net_charge variable.


------------------------------------------------------------------------
r167 | draeger | 2014-03-21 11:14:36 -0700 (Fri, 21 Mar 2014) | 4 lines


Added option to copy data in place to separate square contexts to speed up square matrix operations (eigensolve and Cholesky decomposition).  Currently disabled.


------------------------------------------------------------------------
r166 | draeger | 2014-03-17 09:48:49 -0700 (Mon, 17 Mar 2014) | 4 lines


Bug fix:  removed extra argument from runtime() in ParallelOptimizer.C.


------------------------------------------------------------------------
r165 | draeger | 2014-03-17 09:45:21 -0700 (Mon, 17 Mar 2014) | 4 lines


Removed context reshaping option.  Instead, we'll do an in-place copy from rectangular context to square context.


------------------------------------------------------------------------
r158 | draeger1 | 2014-01-16 13:59:17 -0800 (Thu, 16 Jan 2014) | 4 lines


Added dj3 term to NonLocalPotential.C, allowing users to use semilocal potentials with nonlocal l=3 channels.


------------------------------------------------------------------------
r156 | draeger1 | 2013-12-20 11:37:48 -0800 (Fri, 20 Dec 2013) | 4 lines


Fixed bug with load -states when checkpoint files are not found and nstloc = 0 on some tasks.


------------------------------------------------------------------------
r153 | draeger1 | 2013-12-02 13:13:35 -0800 (Mon, 02 Dec 2013) | 4 lines


Added missing WfExtrap.h file to repo.  WfExtrap.h adds variable to choose wf extrapolation method for MD.


------------------------------------------------------------------------
r152 | draeger1 | 2013-12-02 13:05:54 -0800 (Mon, 02 Dec 2013) | 4 lines


Added xml .mk for vulcan.


------------------------------------------------------------------------
r149 | draeger1 | 2013-11-05 10:37:53 -0800 (Tue, 05 Nov 2013) | 4 lines


Fixed bug in load -states when loading states into block-cyclic distribution (e.g. set with matrix_loc or pblock variables).


------------------------------------------------------------------------
r148 | draeger1 | 2013-11-04 12:52:11 -0800 (Mon, 04 Nov 2013) | 4 lines


Fixed bug where wf_extrap value of ASP was not picked up by BOSampleStepper.


------------------------------------------------------------------------
r147 | draeger1 | 2013-10-31 10:39:08 -0700 (Thu, 31 Oct 2013) | 4 lines


Updated savesys command to print out lock commands for locked atoms.


------------------------------------------------------------------------
r146 | draeger1 | 2013-10-23 11:05:36 -0700 (Wed, 23 Oct 2013) | 4 lines


Updated promote_occ command to allow optional argument to set spin channels independently.  If nspin > 1 and no additional spin argument is provided, promote_occ will promote both spin channels.


------------------------------------------------------------------------
r145 | draeger1 | 2013-10-22 16:47:52 -0700 (Tue, 22 Oct 2013) | 4 lines


Added scf_ef timer to BOSampleStepper to capture more complete timing profile of work within scfloop.


------------------------------------------------------------------------
r144 | draeger1 | 2013-09-27 11:47:19 -0700 (Fri, 27 Sep 2013) | 4 lines


Added savewffreq variable to save all/one state every X MD iterations.


------------------------------------------------------------------------
r143 | draeger1 | 2013-09-18 10:59:17 -0700 (Wed, 18 Sep 2013) | 4 lines


Added second argument to savedenfreq to allow user to specify base filename and path for density snapshots.


------------------------------------------------------------------------
r142 | draeger1 | 2013-08-29 12:06:38 -0700 (Thu, 29 Aug 2013) | 4 lines


Fixed bug in EmpiricalPotentialCmd where arguments were being passed to EmpiricalPotential in wrong order.


------------------------------------------------------------------------
r141 | draeger1 | 2013-08-28 13:20:52 -0700 (Wed, 28 Aug 2013) | 4 lines


Added support for atoms_dyn IMPULSIVE (constant velocities) with BOSampleStepper.


------------------------------------------------------------------------
r140 | draeger1 | 2013-08-26 15:05:04 -0700 (Mon, 26 Aug 2013) | 4 lines


Added if statements to avoid hangs/crashes with very large nrowmax values, where the number of G-vectors in the basis is on the order of nrowmax.  Fixed paropt command, tested successfully with mgo480 and 8k-32k MPI tasks on vulcan.


------------------------------------------------------------------------
r139 | draeger1 | 2013-08-23 17:09:49 -0700 (Fri, 23 Aug 2013) | 4 lines


Implemented nspin > 1 for save -casino.


------------------------------------------------------------------------
r138 | draeger1 | 2013-08-23 12:22:07 -0700 (Fri, 23 Aug 2013) | 4 lines


Updated HPC_BENCHMARK readme file to give more explicit details for CORAL and Trinity benchmarks.


------------------------------------------------------------------------
r137 | draeger1 | 2013-08-21 10:15:29 -0700 (Wed, 21 Aug 2013) | 4 lines


Added barriers after Alltoallv calls in FourierTransform to prevent them from causing performance bottleneck for some grids and nrowmax values.


------------------------------------------------------------------------
r136 | draeger1 | 2013-08-20 10:11:12 -0700 (Tue, 20 Aug 2013) | 4 lines


After extensive testing, reimplemented change to col_ctxt creation:  it should just reduce memory costs associated with creating new BLACS contexts repeatedly vs. simply passing references.


------------------------------------------------------------------------
r135 | draeger1 | 2013-07-30 11:26:39 -0700 (Tue, 30 Jul 2013) | 4 lines


Fixed bug in saveesp command.


------------------------------------------------------------------------
r134 | draeger1 | 2013-07-29 13:15:31 -0700 (Mon, 29 Jul 2013) | 4 lines


Updated saveesp command to include VMD, molmol and gopenmol support and added extra if block for all save commands to avoid calling dsend and isend on data from tasks where np012loc == 0.


------------------------------------------------------------------------
r133 | draeger1 | 2013-07-24 11:38:03 -0700 (Wed, 24 Jul 2013) | 4 lines


Bug fix in r128 didn't actually fix the underlying bug, which was the nlcc density not being broadcast to other tasks by SpeciesReader for norm-conserving pseudopotentials.  Fixed in this revision.


------------------------------------------------------------------------
r132 | draeger1 | 2013-07-23 10:30:13 -0700 (Tue, 23 Jul 2013) | 4 lines


Added wf_extrapolation variable to let user choose extrapolation method during MD (allowed values:  ASP, NTC, SIMPLE, OFF).


------------------------------------------------------------------------
r131 | draeger1 | 2013-07-17 11:42:30 -0700 (Wed, 17 Jul 2013) | 4 lines


Fixed bug where ultrasoft runs with a single atom of a given species can crash when nrowmax != npes.


------------------------------------------------------------------------
r130 | draeger1 | 2013-07-17 11:29:25 -0700 (Wed, 17 Jul 2013) | 4 lines


Don't initialize hamil_wf unless ctrl.tddft_involved is true, causes crash with ultrasoft.


------------------------------------------------------------------------
r129 | draeger1 | 2013-07-16 12:29:05 -0700 (Tue, 16 Jul 2013) | 4 lines


Fixed bug in SpeciesReader where potentials whose local channel did not have a radial_function defined and where lloc < lmax were trying to skip ahead to the next radial_function and then crashing the loop.  


------------------------------------------------------------------------
r128 | draeger1 | 2013-07-16 10:50:52 -0700 (Tue, 16 Jul 2013) | 4 lines


Rolled back col_ctxt change from r125 after user reported hang / anomalous results.  


------------------------------------------------------------------------
r127 | draeger1 | 2013-07-15 14:07:01 -0700 (Mon, 15 Jul 2013) | 4 lines


Added set_velocity command.


------------------------------------------------------------------------
r126 | draeger1 | 2013-07-15 12:28:33 -0700 (Mon, 15 Jul 2013) | 4 lines


Fixed randomize_vel command to actually rescale the velocities to the target temperature.


------------------------------------------------------------------------
r125 | draeger1 | 2013-07-15 09:20:09 -0700 (Mon, 15 Jul 2013) | 4 lines


Added parsing for non-linear core corrections with norm-conserving pseudopotentials to SpeciesReader.C.  


------------------------------------------------------------------------
r124 | draeger1 | 2013-07-12 17:17:11 -0700 (Fri, 12 Jul 2013) | 4 lines


Modified Wavefunction(const& Wavefunction) constructor so that new subcommunicators were not being created for single-column contexts each and every time it was called, instead calling the Context(const& Context) constructor.  This should fix the "Out of communicators" error on BG/Q when npcol > 128.


------------------------------------------------------------------------
r123 | draeger1 | 2013-07-12 12:16:07 -0700 (Fri, 12 Jul 2013) | 4 lines


Fixed bug where mixed charge density was not loaded from checkpoint or between run statements.


------------------------------------------------------------------------
r122 | draeger1 | 2013-07-10 11:06:42 -0700 (Wed, 10 Jul 2013) | 4 lines


Added counter to Timer.h so total number of calls is printed along with timing.


------------------------------------------------------------------------
r121 | draeger1 | 2013-07-09 20:18:32 -0700 (Tue, 09 Jul 2013) | 4 lines


Fixed occasional hang bug when timings are printed, caused by NonLocalPotential having a tmap start/stop call inside an if (nstloc > 0) block for systems where nst/nb < npcol-1.


------------------------------------------------------------------------
r120 | draeger1 | 2013-07-05 18:24:10 -0700 (Fri, 05 Jul 2013) | 4 lines


Casino output bug fixes.


------------------------------------------------------------------------
r119 | draeger1 | 2013-07-03 13:13:51 -0700 (Wed, 03 Jul 2013) | 4 lines


Minor tweak to Makefile.


------------------------------------------------------------------------
r118 | draeger1 | 2013-07-03 12:41:16 -0700 (Wed, 03 Jul 2013) | 4 lines


Bug fix:  load -xml was resizing wavefunction with nrowmax=npes to test parallel k-point and spin checkpointing.  Removed this to deal with crashes on BG/Q, though that problem still needs to be solved.  


------------------------------------------------------------------------
r117 | draeger1 | 2013-07-03 10:40:24 -0700 (Wed, 03 Jul 2013) | 3 lines

Removed omp pragmas from EnergyFunctional.C which caused incorrect results in some cases.


------------------------------------------------------------------------
r116 | draeger1 | 2013-07-01 09:41:20 -0700 (Mon, 01 Jul 2013) | 4 lines


Fixed bug in save -casino that prevented the Basis from being printed for k-points that weren't on pe 0.


------------------------------------------------------------------------
r115 | draeger1 | 2013-06-18 12:17:02 -0700 (Tue, 18 Jun 2013) | 4 lines


Fixed bug where an uninitialized s->hamil_wf was used in construction of hamil_cd in EnergyFunctional constructor if tddft was run without an explicit load command.


------------------------------------------------------------------------
r114 | draeger1 | 2013-06-13 09:42:55 -0700 (Thu, 13 Jun 2013) | 4 lines


Added function to compute ion-ion (Ewald) energy term for CASINO output.


------------------------------------------------------------------------
r113 | draeger1 | 2013-06-07 16:19:37 -0700 (Fri, 07 Jun 2013) | 4 lines


Updated save -casino command to print separate files for each k-point.


------------------------------------------------------------------------
r112 | draeger1 | 2013-05-30 15:12:44 -0700 (Thu, 30 May 2013) | 4 lines


Fixed testChargeDensity (default values for ctrl options not being set, since variables weren't included)


------------------------------------------------------------------------
r111 | draeger1 | 2013-05-30 14:44:06 -0700 (Thu, 30 May 2013) | 4 lines


Removed fastend option from BOSampleStepper.C for BG/Q, updated gold benchmark to choose better nrowmax and use run 0 1 5 by default, and added MgO example to examples directory.


------------------------------------------------------------------------
r110 | draeger1 | 2013-05-28 18:23:20 -0700 (Tue, 28 May 2013) | 4 lines


Changed how timing is printed out in BOSampleStepper.C.


------------------------------------------------------------------------
r109 | draeger1 | 2013-05-24 14:48:16 -0700 (Fri, 24 May 2013) | 4 lines


Use mditer+1 instead of mditer to determine savefreq, savedenfreq.


------------------------------------------------------------------------
r107 | draeger1 | 2013-05-24 13:02:09 -0700 (Fri, 24 May 2013) | 3 lines

Added savefreq and savedenfreq variables to allow saving every x MD iterations within an iteration loop.


------------------------------------------------------------------------
r106 | draeger1 | 2013-05-20 18:10:35 -0700 (Mon, 20 May 2013) | 4 lines


Updated make install option to update symlinks.


------------------------------------------------------------------------
r105 | draeger1 | 2013-05-20 17:14:28 -0700 (Mon, 20 May 2013) | 4 lines


Fixed bug in print_casino.


------------------------------------------------------------------------
r104 | draeger1 | 2013-05-16 10:58:25 -0700 (Thu, 16 May 2013) | 4 lines


Added ALIGN4 macro to force mb%4==0 when matrix_loc, pblock not defined.


------------------------------------------------------------------------
r103 | draeger1 | 2013-05-15 14:49:54 -0700 (Wed, 15 May 2013) | 4 lines


Added pblock variable, allowing user to select target number of local blocks in block-cyclic distribution.


------------------------------------------------------------------------
r102 | draeger1 | 2013-05-15 14:04:00 -0700 (Wed, 15 May 2013) | 4 lines


Tweaks to Makefile to allow more robust building of qblink with and without Xerces.


------------------------------------------------------------------------
r101 | draeger1 | 2013-05-13 10:32:21 -0700 (Mon, 13 May 2013) | 4 lines


Bug fix to allow matrix_loc variable to be used and correctly resize matrices immediately (ideally, set matrix_loc command should be at or near the top of the input file, definitely before randomize_wf or load commands).


------------------------------------------------------------------------
r100 | draeger1 | 2013-05-10 10:48:04 -0700 (Fri, 10 May 2013) | 4 lines


More edits to tweak local data sizes.


------------------------------------------------------------------------
r98 | draeger1 | 2013-05-08 16:54:56 -0700 (Wed, 08 May 2013) | 4 lines


Modified logic of SlaterDet.resize to enforce values of nb that distribute across all process columns, fixing hangs during print_timing at the end of BOSampleStepper.


------------------------------------------------------------------------
r97 | draeger1 | 2013-05-08 12:00:25 -0700 (Wed, 08 May 2013) | 4 lines


Added test codes to analyze timings of pgemm, eigensolve with different block sizes.


------------------------------------------------------------------------
r96 | draeger1 | 2013-05-08 11:45:32 -0700 (Wed, 08 May 2013) | 4 lines


Wrote Gram-Schmidt test code to time different terms in Gram-Schmidt orthogonalization with different local block sizes.


------------------------------------------------------------------------
r95 | draeger1 | 2013-05-07 16:38:19 -0700 (Tue, 07 May 2013) | 4 lines


Added -vmd option to saveden command.  Added matrix_loc option to allow explicit manual definition of local block sizes used by SlaterDet::resize.  


------------------------------------------------------------------------
r94 | draeger1 | 2013-05-07 16:36:05 -0700 (Tue, 07 May 2013) | 4 lines


Added promote_occ command, modified local block size options for 32-byte alignment on BG/Q.


------------------------------------------------------------------------
r92 | draeger1 | 2013-04-26 10:18:46 -0700 (Fri, 26 Apr 2013) | 4 lines


Added support for Xerces 3.1, which configures and compiles nicely on BG/Q.  Changed macro used to trigger 32-byte aligned blocksizes from BGQ to ALIGN32 for finer control.


------------------------------------------------------------------------
r91 | draeger1 | 2013-04-25 09:34:42 -0700 (Thu, 25 Apr 2013) | 4 lines


Added promote_occ command to enable excited states in TDDFT calculations.


------------------------------------------------------------------------
r90 | draeger1 | 2013-04-22 14:38:37 -0700 (Mon, 22 Apr 2013) | 4 lines


Changed default value of mdsave to -states, fixed bug where mdsave -states was not using md.00* subdirectory.


------------------------------------------------------------------------
r89 | draeger1 | 2013-04-18 15:53:10 -0700 (Thu, 18 Apr 2013) | 4 lines


Fixed bug in load -states and load -fast with TDDFT where hamil_wf checkpoint files were missing (i.e. after converging ground state) and hamil_wf was set to s_.wf but then cleared, giving an incorrect energy after first iteration.


------------------------------------------------------------------------
r87 | draeger1 | 2013-04-18 14:08:34 -0700 (Thu, 18 Apr 2013) | 4 lines


Removed some unnecessary .mk include files.


------------------------------------------------------------------------
r85 | draeger1 | 2013-04-18 11:32:16 -0700 (Thu, 18 Apr 2013) | 3 lines

Updated source code with GPL header.


------------------------------------------------------------------------
r84 | draeger1 | 2013-04-18 09:45:59 -0700 (Thu, 18 Apr 2013) | 4 lines


Updated testPgemm code.


------------------------------------------------------------------------
r83 | draeger1 | 2013-04-16 14:09:53 -0700 (Tue, 16 Apr 2013) | 4 lines


Added info to set_nrowmax to check that value is a multiple of BG/Q torus dimensions when BG/Q and CTF are used.


------------------------------------------------------------------------
r82 | draeger1 | 2013-04-09 10:15:35 -0700 (Tue, 09 Apr 2013) | 4 lines


Removed unnecessary gram() call from EhrenSampleStepper.


------------------------------------------------------------------------
r81 | draeger1 | 2013-03-05 11:21:31 -0800 (Tue, 05 Mar 2013) | 3 lines

Fixed bug in load -states when nrowmax < npes and nempty > 0.


------------------------------------------------------------------------
r80 | draeger1 | 2013-03-01 17:06:50 -0800 (Fri, 01 Mar 2013) | 3 lines

Removed BGQ hack from rewritten save/load -states, as it is hopefully now unnecessary.


------------------------------------------------------------------------
r79 | draeger1 | 2013-03-01 17:04:40 -0800 (Fri, 01 Mar 2013) | 6 lines


Rewrote load/save -states commands to (hopefully) be faster and more
efficient.  Loading from old states checkpoints won't work, one needs
to load/save -states-old to access that format.


------------------------------------------------------------------------
r78 | draeger1 | 2013-02-27 10:42:58 -0800 (Wed, 27 Feb 2013) | 4 lines


Updated Makefile.arch with better defaults.


------------------------------------------------------------------------
r76 | draeger1 | 2013-02-27 09:13:06 -0800 (Wed, 27 Feb 2013) | 4 lines


Moved ehrenfest branch to trunk.


------------------------------------------------------------------------
r74 | draeger1 | 2013-02-15 17:01:28 -0800 (Fri, 15 Feb 2013) | 4 lines


Bug fix for Harris-Foulkes convergence estimator.


------------------------------------------------------------------------
r73 | draeger1 | 2013-02-14 15:33:32 -0800 (Thu, 14 Feb 2013) | 4 lines


Changed scf_threshold to use etot_harris, not etotal_int, to detect convergence.


------------------------------------------------------------------------
r72 | draeger1 | 2013-02-14 15:29:43 -0800 (Thu, 14 Feb 2013) | 4 lines


Removed non-scf threshold.


------------------------------------------------------------------------
r71 | draeger1 | 2013-02-14 15:22:10 -0800 (Thu, 14 Feb 2013) | 4 lines


Fixed bug in load -states with ultrasoft (hopefully), and rewrote Harris-Foulkes energy calculation and output.


------------------------------------------------------------------------
r70 | draeger1 | 2013-02-13 21:02:49 -0800 (Wed, 13 Feb 2013) | 4 lines


Added Harris-Foulkes energy estimate for convergence detection.


------------------------------------------------------------------------
r69 | draeger1 | 2013-02-07 17:04:16 -0800 (Thu, 07 Feb 2013) | 4 lines


Threaded update loop in rs_mul_add, which signficantly improves performance on BG/Q.


------------------------------------------------------------------------
r68 | draeger1 | 2013-02-07 16:08:37 -0800 (Thu, 07 Feb 2013) | 4 lines


Threaded update loop in SlaterDet::compute_density, which was consuming the vast majority of the compute time on BG/Q.


------------------------------------------------------------------------
r67 | draeger1 | 2013-02-07 14:42:07 -0800 (Thu, 07 Feb 2013) | 4 lines


Bug fix for load -fast.


------------------------------------------------------------------------
r66 | draeger1 | 2013-02-07 10:46:26 -0800 (Thu, 07 Feb 2013) | 4 lines


Added save -fast option to try to improve I/O performance and reliability on BG/Q.  Added additional OpenMP pragmas to EnergyFunctional.


------------------------------------------------------------------------
r65 | draeger1 | 2013-01-29 11:36:14 -0800 (Tue, 29 Jan 2013) | 4 lines


Prepped headers for source release.


------------------------------------------------------------------------
r64 | draeger1 | 2013-01-29 11:11:37 -0800 (Tue, 29 Jan 2013) | 4 lines


Merged trunk BOSampleStepper, other minor edits into ehrenfest branch.


------------------------------------------------------------------------
r63 | draeger1 | 2013-01-14 09:23:40 -0800 (Mon, 14 Jan 2013) | 4 lines


Fix to mditer reading from file.


------------------------------------------------------------------------
r62 | draeger1 | 2013-01-11 14:58:01 -0800 (Fri, 11 Jan 2013) | 4 lines


Added filebase information to "skipping load" warning message to avoid confusion.


------------------------------------------------------------------------
r61 | draeger1 | 2013-01-07 17:31:31 -0800 (Mon, 07 Jan 2013) | 4 lines


Added mdsave function for easier MD checkpointing.


------------------------------------------------------------------------
r60 | draeger1 | 2013-01-07 13:08:13 -0800 (Mon, 07 Jan 2013) | 4 lines


Added MDIter variable, for better managing ongoing MD runs and checkpointing.


------------------------------------------------------------------------
r59 | draeger1 | 2013-01-07 11:09:13 -0800 (Mon, 07 Jan 2013) | 4 lines


Fixed energy discontinuity in checkpoint restart by storing hamil_wf and initializing hamil_wf explicitly.  


------------------------------------------------------------------------
r58 | draeger1 | 2013-01-02 18:26:35 -0800 (Wed, 02 Jan 2013) | 4 lines


Modified save and load commands to also save hamil_wf when tddft is used to avoid discontinuities after restart.


------------------------------------------------------------------------
r57 | draeger1 | 2012-12-17 16:46:01 -0800 (Mon, 17 Dec 2012) | 4 lines


Fixed bug w. TDDFT and load -states (need to avoid trying to load mixed charge density).


------------------------------------------------------------------------
r53 | draeger1 | 2012-11-28 13:32:55 -0800 (Wed, 28 Nov 2012) | 4 lines


Bug fix in USE_SPIRAL call to zdscal.


------------------------------------------------------------------------
r52 | draeger1 | 2012-11-27 17:45:18 -0800 (Tue, 27 Nov 2012) | 4 lines


Rewrote FourierTransform.C to use fftw_one calls when USE_SPIRAL is defined.


------------------------------------------------------------------------
r51 | draeger1 | 2012-11-27 16:38:59 -0800 (Tue, 27 Nov 2012) | 4 lines


Reverted FourierTransform.C to original version after Davis version (w. fftw_one calls throughout) crashed.


------------------------------------------------------------------------
r50 | draeger1 | 2012-11-21 18:45:07 -0800 (Wed, 21 Nov 2012) | 4 lines


Modifed FourierTransform.C to allow fftw_one calls needed by the Spiral FFT library.  Add hack that only uses fftw_one for x- and y- transforms, as Spiral can't do the sizes we're currently doing w. gold in z-direction.


------------------------------------------------------------------------
r49 | draeger1 | 2012-11-15 14:10:57 -0800 (Thu, 15 Nov 2012) | 4 lines


Cleaned up EhrenSampleStepper.


------------------------------------------------------------------------
r48 | draeger1 | 2012-11-15 10:16:44 -0800 (Thu, 15 Nov 2012) | 4 lines


Finished initial rewriting of EhrenSampleStepper.


------------------------------------------------------------------------
r47 | draeger1 | 2012-11-14 13:24:58 -0800 (Wed, 14 Nov 2012) | 4 lines


Writing new EhrenSampleStepper, still in progress.


------------------------------------------------------------------------
r46 | draeger1 | 2012-10-10 13:10:14 -0700 (Wed, 10 Oct 2012) | 4 lines


Bug fix:  diag not called when tddft_involved_ is true.


------------------------------------------------------------------------
r45 | draeger1 | 2012-10-05 13:15:17 -0700 (Fri, 05 Oct 2012) | 4 lines


Removed binary files.


------------------------------------------------------------------------
r44 | draeger1 | 2012-10-05 13:13:55 -0700 (Fri, 05 Oct 2012) | 4 lines


Added missing files.


------------------------------------------------------------------------
r43 | draeger1 | 2012-10-05 13:12:39 -0700 (Fri, 05 Oct 2012) | 3 lines

Copied src-ehren into branch directory.


------------------------------------------------------------------------
r42 | draeger1 | 2012-10-05 11:27:50 -0700 (Fri, 05 Oct 2012) | 4 lines


Added branch for TDDFT ehrenfest code.


------------------------------------------------------------------------
r40 | draeger1 | 2012-10-05 10:29:33 -0700 (Fri, 05 Oct 2012) | 4 lines


Bug fix for MD w. ultrasoft -- ultrasoft functions needed updating at start of iter loop and after extrapolation to maintain consistency.


------------------------------------------------------------------------
r39 | draeger1 | 2012-10-01 15:49:47 -0700 (Mon, 01 Oct 2012) | 4 lines


Fixed bug in norm-conserving force calculation caused by incorrect sizes passed to dgemm and zgemm.


------------------------------------------------------------------------
r38 | draeger1 | 2012-10-01 11:02:35 -0700 (Mon, 01 Oct 2012) | 4 lines


Forced consistent occupation weighting in PSDAWFStepper, removed one of the ndft_ *= 2 lines from Species.C.


------------------------------------------------------------------------
r37 | draeger1 | 2012-09-10 14:17:38 -0700 (Mon, 10 Sep 2012) | 4 lines


Bug fix for DFT+U, where species need to be reinitialized once U values are defined.


------------------------------------------------------------------------
r36 | draeger1 | 2012-07-24 09:53:34 -0700 (Tue, 24 Jul 2012) | 4 lines


Typo fix.


------------------------------------------------------------------------
r35 | draeger1 | 2012-07-24 09:49:43 -0700 (Tue, 24 Jul 2012) | 4 lines


Added net_charge variable. 


------------------------------------------------------------------------
r34 | draeger1 | 2012-07-02 16:41:53 -0700 (Mon, 02 Jul 2012) | 4 lines


Added BGQ flags to alter save/load -states header to avoid zero file-length bug.


------------------------------------------------------------------------
r33 | draeger1 | 2012-06-20 13:24:45 -0700 (Wed, 20 Jun 2012) | 4 lines


Added #BGQ block to force 32-byte alignment in Basis.C


------------------------------------------------------------------------
r32 | draeger1 | 2012-06-19 11:52:53 -0700 (Tue, 19 Jun 2012) | 4 lines


Moved randomize_wf call for uninitialized Wavefunction from Ecut.h to RunCmd.C


------------------------------------------------------------------------
r31 | draeger1 | 2012-06-15 15:05:36 -0700 (Fri, 15 Jun 2012) | 3 lines

Updated Basis from Davis code, fixed bug in NonLocalPotential.C (gemms were incorrectly using mloc instead of ngwl) which give non-integer charge.


------------------------------------------------------------------------
r30 | draeger1 | 2012-06-12 15:23:04 -0700 (Tue, 12 Jun 2012) | 4 lines


Added standalone gram and pgemm test codes.


------------------------------------------------------------------------
r29 | draeger1 | 2012-06-01 15:36:59 -0700 (Fri, 01 Jun 2012) | 4 lines


Added #include <cstring> to allow compilation on Chaos5.


------------------------------------------------------------------------
r28 | draeger1 | 2012-04-25 18:23:32 -0700 (Wed, 25 Apr 2012) | 4 lines


Implemented pzheevx.


------------------------------------------------------------------------
r27 | draeger1 | 2012-04-24 21:52:05 -0700 (Tue, 24 Apr 2012) | 4 lines


Added pzheevr to Matrix.C.  Tests on rzuseq gave reasonable answers but only with OMP_NUM_THREADS = 1.  


------------------------------------------------------------------------
r26 | draeger1 | 2012-04-22 14:26:33 -0700 (Sun, 22 Apr 2012) | 1 line


------------------------------------------------------------------------
r25 | draeger1 | 2012-04-22 14:22:20 -0700 (Sun, 22 Apr 2012) | 4 lines


Updated local data resizing to (a) match latest jagzgemm library and (b) not give electronic charge error when mloc ends up larger than basis.maxlocalsize


------------------------------------------------------------------------
r24 | draeger1 | 2012-04-20 11:17:54 -0700 (Fri, 20 Apr 2012) | 4 lines


Updates from BG/Q optimization, shouldn't affect any other platforms.


------------------------------------------------------------------------
r23 | draeger1 | 2012-04-15 11:53:47 -0700 (Sun, 15 Apr 2012) | 4 lines


Modified code to allow Tau profiling, use of John Gunnels' custom zgemm on BG/Q w. local data sizes aligned for maximal performance.


------------------------------------------------------------------------
r21 | draeger1 | 2012-04-13 13:16:30 -0700 (Fri, 13 Apr 2012) | 4 lines


Updated .mk files to use ESSL for FFTs on BGQ (much faster), added tau profiling .mk file.


------------------------------------------------------------------------
r20 | draeger1 | 2012-04-12 15:43:58 -0700 (Thu, 12 Apr 2012) | 4 lines


Added BGQ-only calls to enforce 32-byte alignment in matrix sizes and (optionally) to call custom dgemm and zgemm routines.  


------------------------------------------------------------------------
r19 | draeger1 | 2012-04-03 17:36:00 -0700 (Tue, 03 Apr 2012) | 4 lines


Added custom zdotc function to NonLocalPotential.C, for the case of memory >= large.


------------------------------------------------------------------------
r18 | draeger1 | 2012-04-03 13:38:40 -0700 (Tue, 03 Apr 2012) | 4 lines


Got threaded ChargeDensity code working (may still crash on BG/Q w. npcol > natoms for any species).


------------------------------------------------------------------------
r17 | draeger1 | 2012-04-02 17:42:33 -0700 (Mon, 02 Apr 2012) | 4 lines


Rewrote ChargeDensity to use zgemm and a SIMDized C function to improve BG/Q performance.


------------------------------------------------------------------------
r16 | draeger1 | 2012-04-01 19:39:47 -0700 (Sun, 01 Apr 2012) | 4 lines


Fixed timer hang in NonLocalPotential.C when betapsi only nonzero on some tasks.


------------------------------------------------------------------------
r15 | draeger1 | 2012-03-28 16:20:58 -0700 (Wed, 28 Mar 2012) | 1 line


------------------------------------------------------------------------
r14 | draeger1 | 2012-03-28 16:12:40 -0700 (Wed, 28 Mar 2012) | 4 lines


Added single-node test codes for dgemm, zgemm.


------------------------------------------------------------------------
r13 | draeger1 | 2012-03-28 16:11:12 -0700 (Wed, 28 Mar 2012) | 4 lines


Adding print_timer functions, reformatted timer output and added some OpenMP directives to ChargeDensity, SlaterDet, NonLocalPotential.  More OpenMP needs to be added, but some rewriting may need to be done to enforce private data and avoid race conditions.


------------------------------------------------------------------------
r12 | draeger1 | 2012-03-13 12:21:35 -0700 (Tue, 13 Mar 2012) | 3 lines

Added factor of 1/nspin to nlcc terms, fixed bug w. spin.


------------------------------------------------------------------------
r11 | draeger1 | 2012-03-13 11:48:09 -0700 (Tue, 13 Mar 2012) | 3 lines

Another nlcc bug fix.


------------------------------------------------------------------------
r10 | draeger1 | 2012-03-13 11:32:10 -0700 (Tue, 13 Mar 2012) | 3 lines

Bug fix for nlcc for nspin > 1.  Still wrong, however.


------------------------------------------------------------------------
r9 | draeger1 | 2012-03-13 11:11:25 -0700 (Tue, 13 Mar 2012) | 3 lines

Fixed nlcc force calculation.


------------------------------------------------------------------------
r8 | draeger1 | 2012-02-29 09:32:47 -0800 (Wed, 29 Feb 2012) | 3 lines

Added update_usfns to SlaterDet.gram, to be sure that spsi is updated after orthogonalization (needed to ensure diag assumptions of psi^t(spsi) = identity.


------------------------------------------------------------------------
r7 | draeger1 | 2012-02-23 11:42:07 -0800 (Thu, 23 Feb 2012) | 3 lines

Threaded the FourierTransform w. OpenMP.


------------------------------------------------------------------------
r6 | draeger1 | 2012-02-14 16:21:47 -0800 (Tue, 14 Feb 2012) | 3 lines

Added warnings about using stress with ultrasoft or nlcc (not implemented), and a test for nlcc forces.


------------------------------------------------------------------------
r5 | draeger1 | 2012-02-07 10:59:24 -0800 (Tue, 07 Feb 2012) | 3 lines

Fixed ParallelOptimizer w. ultrasoft, including SlaterDet.resize that failed w. spsi.


------------------------------------------------------------------------
r4 | draeger1 | 2012-02-06 13:39:18 -0800 (Mon, 06 Feb 2012) | 3 lines

Fixed bug in checkpointing with nlcc, and in save -vmd w. ultrasoft.


------------------------------------------------------------------------
r1 | draeger1 | 2012-02-06 10:33:34 -0800 (Mon, 06 Feb 2012) | 3 lines

Initial TeamForge commmit of qb@ll 2.0 source code.  This is the first official release of qb@ll with ultrasoft pseudopotentials and non-linear core corrections.  


------------------------------------------------------------------------
